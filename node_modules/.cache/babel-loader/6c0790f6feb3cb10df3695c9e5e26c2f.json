{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\usuario\\\\Desktop\\\\Server Elsa\\\\PW serverElsa\\\\React\\\\PandaCraftWeb\\\\src\\\\components\\\\Rating.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Link } from \"react-router-dom\";\nimport StaffCard from './StaffCard';\nimport './css/profile.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Rating(props) {\n  _s();\n\n  var _props$user;\n\n  const user = props.user;\n  const datos = document.getElementById('datos');\n  /*const rate = async () => {\r\n      const result = await fetch('http://localhost:3001/api/user/update/' + user.id)\r\n      .then(res => res.json())\r\n      .then(res => {\r\n        })\r\n  }*/\n\n  const [staffs, setStaffs] = useState([]);\n  const [rate, setRate] = useState({});\n\n  const vote = async () => {\n    await fetch('http://localhost:3001/api/staff/update/', {\n      method: 'PATCH',\n      body: JSON.stringify({\n        rank: rate.staffRated.rank,\n        name: rate.staffRated.name,\n        rating: {\n          rates: {\n            _1: rate.rate === 1 ? 1 : 0,\n            _2: rate.rate === 2 ? 1 : 0,\n            _3: rate.rate === 3 ? 1 : 0,\n            _4: rate.rate === 4 ? 1 : 0,\n            _5: rate.rate === 5 ? 1 : 0,\n            total: 1\n          }\n        }\n      }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8'\n      }\n    }).then(res => res.json()).then(res => {}).catch(err => {\n      datos.innerHTML = `<span style=\"color: red\">${err.message}</span>`;\n    });\n    await fetch('http://localhost:3001/api/user/update/', {\n      method: 'PATCH',\n      body: JSON.stringify({\n        userName: user.userName,\n        rating: {\n          rated: true,\n          day: Date.now(),\n          staff: rate.staffRated,\n          rating: rate.rate\n        }\n      }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8'\n      }\n    }).then(res => res.json()).then(res => {}).catch(err => {\n      datos.innerHTML = `<span style=\"color: red\">${err.message}</span>`;\n    });\n    await fetch('http://localhost:3001/api/comment/post/', {\n      method: 'PATCH',\n      body: JSON.stringify({\n        user: user,\n        comment: rate.comment\n      }),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8'\n      }\n    }).then(res => res.json()).then(res => {}).catch(err => {\n      datos.innerHTML = `<span style=\"color: red\">${err.message}</span>`;\n    });\n  };\n\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      await fetch('http://localhost:3001/api/staff/getAll').then(res => res.json()).then(res => {\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        let array = [];\n        let cont = 1;\n\n        if (res.length === 0) {\n          datos.innerHTML = '<span style=\"color: red\">No hay datos para mostrar</span>';\n          return;\n        }\n\n        for (let ob of res) {\n          array.push( /*#__PURE__*/_jsxDEV(StaffCard, {\n            number: cont,\n            staff: ob,\n            user: user,\n            rate: setRate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 32\n          }, this));\n          cont++;\n        }\n\n        setStaffs(array);\n        console.log(staffs);\n      }).catch(err => {\n        datos.innerHTML = `<span style=\"color: red\">${err.message}</span>`;\n      });\n    }, 10 * 1000, 5 * 1000);\n    return () => clearInterval(interval);\n  }, [datos, staffs, user, setStaffs]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"subcard grid w-100-p\",\n    id: \"rating\",\n    children: ((_props$user = props.user) === null || _props$user === void 0 ? void 0 : _props$user.userPermision) === 4 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col w-100-p\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        id: \"staffCards\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"datos\",\n          className: \"text-S\",\n          children: staffs\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"enlaces\",\n          children: [/*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"\",\n            className: \"buttonVoto\",\n            onClick: vote,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 29\n            }, this), \"Votar\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"staff\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 29\n            }, this), \"A\\xF1adir staff\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"staff/account\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 29\n            }, this), \"A\\xF1adir usuario staff\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this) : ''\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Rating, \"LGbFT6BccHXP4ybw7nxAQp7fP60=\");\n\n_c = Rating;\n\nvar _c;\n\n$RefreshReg$(_c, \"Rating\");","map":{"version":3,"names":["React","useEffect","useState","Link","StaffCard","Rating","props","user","datos","document","getElementById","staffs","setStaffs","rate","setRate","vote","fetch","method","body","JSON","stringify","rank","staffRated","name","rating","rates","_1","_2","_3","_4","_5","total","headers","then","res","json","catch","err","innerHTML","message","userName","rated","day","Date","now","staff","comment","interval","setInterval","array","cont","length","ob","push","console","log","clearInterval","userPermision"],"sources":["C:/Users/usuario/Desktop/Server Elsa/PW serverElsa/React/PandaCraftWeb/src/components/Rating.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Link } from \"react-router-dom\";\r\nimport StaffCard from './StaffCard';\r\nimport './css/profile.scss'\r\n\r\nexport default function Rating(props){\r\n    const user = props.user;\r\n    const datos = document.getElementById('datos')\r\n    /*const rate = async () => {\r\n        const result = await fetch('http://localhost:3001/api/user/update/' + user.id)\r\n        .then(res => res.json())\r\n        .then(res => {\r\n\r\n        })\r\n    }*/\r\n    const [staffs, setStaffs] = useState([])\r\n    const [rate, setRate] = useState({});\r\n\r\n    const vote = async () => {\r\n        await fetch('http://localhost:3001/api/staff/update/', {\r\n            method: 'PATCH',\r\n            body: JSON.stringify({\r\n                rank: rate.staffRated.rank,\r\n                name: rate.staffRated.name,\r\n                rating: {\r\n                    rates: {\r\n                        _1: rate.rate === 1 ? 1 : 0,\r\n                        _2: rate.rate === 2 ? 1 : 0,\r\n                        _3: rate.rate === 3 ? 1 : 0,\r\n                        _4: rate.rate === 4 ? 1 : 0,\r\n                        _5: rate.rate === 5 ? 1 : 0,\r\n                        total: 1\r\n                    }\r\n                }\r\n            }),\r\n            headers: {\r\n                'Content-type': 'application/json; charset=UTF-8'\r\n            }\r\n        })\r\n        .then(res => res.json())\r\n        .then(res => {\r\n\r\n        }).catch(err => {\r\n            datos.innerHTML =`<span style=\"color: red\">${err.message}</span>`\r\n        })\r\n        await fetch('http://localhost:3001/api/user/update/', {\r\n            method: 'PATCH',\r\n            body: JSON.stringify({\r\n                userName: user.userName,\r\n                rating: {\r\n                    rated: true,\r\n                    day: Date.now(),\r\n                    staff: rate.staffRated,\r\n                    rating: rate.rate\r\n                }\r\n            }),\r\n            headers: {\r\n                'Content-type': 'application/json; charset=UTF-8'\r\n            }\r\n        })\r\n        .then(res => res.json())\r\n        .then(res => {\r\n\r\n        }).catch(err => {\r\n            datos.innerHTML =`<span style=\"color: red\">${err.message}</span>`\r\n        })\r\n        \r\n        await fetch('http://localhost:3001/api/comment/post/', {\r\n            method: 'PATCH',\r\n            body: JSON.stringify({\r\n                user: user,\r\n                comment: rate.comment\r\n            }),\r\n            headers: {\r\n                'Content-type': 'application/json; charset=UTF-8'\r\n            }\r\n        })\r\n        .then(res => res.json())\r\n        .then(res => {\r\n\r\n        }).catch(err => {\r\n            datos.innerHTML =`<span style=\"color: red\">${err.message}</span>`\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(async () => {\r\n            await fetch('http://localhost:3001/api/staff/getAll')\r\n            .then(res => res.json())\r\n            .then(res => {\r\n                // eslint-disable-next-line react-hooks/exhaustive-deps\r\n                let array = []\r\n                let cont = 1;\r\n                if(res.length === 0) {\r\n                    datos.innerHTML ='<span style=\"color: red\">No hay datos para mostrar</span>'\r\n                    return\r\n                }\r\n                for(let ob of res){\r\n                    array.push(<StaffCard number={cont} staff={ob} user={user} rate={setRate}/>);\r\n                    cont++\r\n                }\r\n                setStaffs(array)\r\n                console.log(staffs)\r\n            }).catch(err => {\r\n                datos.innerHTML =`<span style=\"color: red\">${err.message}</span>`\r\n            })\r\n        }, 10*1000, 5*1000)\r\n        return () => clearInterval(interval);\r\n    }, [datos, staffs, user, setStaffs]);\r\n\r\n    \r\n\r\n    return(\r\n        <div className='subcard grid w-100-p' id=\"rating\">\r\n            {props.user?.userPermision === 4 ? \r\n            <div className='col w-100-p'>\r\n                <div className='row' id=\"staffCards\">\r\n                    <div id=\"datos\" className='text-S'>{staffs}</div>\r\n                    <div className='enlaces'>\r\n                        <a href=\"\" className=\"buttonVoto\" onClick={vote}>\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            Votar\r\n                        </a> \r\n                        <Link to=\"staff\">\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            Añadir staff\r\n                        </Link> \r\n                        <Link to=\"staff/account\">\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            <span></span>\r\n                            Añadir usuario staff\r\n                        </Link> \r\n                    </div>\r\n                </div>\r\n            </div> : ''}\r\n        </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}